# iOS Pentesting Checklist

### Preparation

* [ ] Read [**iOS Basics**](ios-basics.md)\*\*\*\*
* [ ] Prepare your environment reading ****[**iOS Testing Environment**](ios-testing-environment.md)\*\*\*\*
* [ ] Read all the sections of ****[**iOS Initial Analysis**](./#initial-analysis) ****to learn common actions to pentest an iOS application

### Data Storage

* [ ] [**Plist files**](./#plist) can be used to store sensitive information.
* [ ] \*\*\*\*[**Core Data**](./#core-data) \(SQLite database\) can store sensitive information.
* [ ] \*\*\*\*[**YapDatabases**](./#yapdatabase) \(SQLite database\) can store sensitive information.
* [ ] \*\*\*\*[**Firebase**](./#firebase-real-time-databases) miss-configuration.
* [ ] \*\*\*\*[**Realm databases**](./#realm-databases) can store sensitive information.
* [ ] \*\*\*\*[**Couchbase Lite databases**](./#couchbase-lite-databases) can store sensitive information.
* [ ] \*\*\*\*[**Binary cookies**](./#cookies) can store sensitive information
* [ ] \*\*\*\*[**Cache data**](./#cache) can store sensitive information
* [ ] \*\*\*\*[**Automatic snapshots**](./#snapshots) can save visual sensitive information
* [ ] \*\*\*\*[**Keychain**](./#keychain) is usually used to store sensitive information that can be left when reselling the phone.
* [ ] In summary, just **check for sensitive information saved by the application in the filesystem**

### Keyboards

* [ ] Does the application [**allow to use custom keyboards**](./#custom-keyboards-keyboard-cache)?
* [ ] Check if sensitive information is saved in the [**keyboards cache files**](./#custom-keyboards-keyboard-cache)\*\*\*\*

### **Logs**

* [ ] Check if [**sensitive information is being logged**](./#logs)\*\*\*\*

### Backups

* [ ] \*\*\*\*[**Backups**](./#backups) can be used to **access the sensitive information** saved in the file system \(check the initial point of this checklist\)
* [ ] Also, [**backups**](./#backups) can be used to **modify some configurations of the application**, then **restore** the backup on the phone, and the as the **modified configuration** is **loaded** some \(security\) **functionality** may be **bypassed**

### **Applications Memory**

* [ ] Check for sensitive information inside the [**application's memory**](./#testing-memory-for-sensitive-data)\*\*\*\*

### **Broken Cryptography**

* [ ] Check if yo can find [**passwords used for cryptography**](./#broken-cryptography)\*\*\*\*
* [ ] Check for the use of [**deprecated/weak algorithms**](./#broken-cryptography) to send/store sensitive data
* [ ] \*\*\*\*[**Hook and monitor cryptography functions**](./#broken-cryptography)\*\*\*\*

### **Local Authentication**

* [ ] If a [**local authentication**](./#local-authentication) is used in the application, you should check how the authentication is working.
  * [ ] If it's using the [**Local Authentication Framework**](./#local-authentication-framework) it could be easily bypassed
  * [ ] If it's using a [**function that can dynamically bypassed**](./#local-authentication-using-keychain) you could create a custom frida script

### Sensitive Functionality Exposure Through IPC

* \*\*\*\*[**Custom URI Handlers / Deeplinks / Custom Schemes**](./#custom-uri-handlers-deeplinks-custom-schemes)\*\*\*\*
  * [ ] Check if the application is **registering any protocol/scheme**
  * [ ] Check if the application is **registering to use** any protocol/scheme
  * [ ] Check if the application **expects to receive any kind of sensitive information** from the custom scheme that can be **intercepted** by the another application registering the same scheme
  * [ ] Check if the application **isn't checking and sanitizing** users input via the custom scheme and some **vulnerability can be exploited**
  * [ ] Check if the application **exposes any sensitive action** that can be called from anywhere via the custom scheme
* \*\*\*\*[**Universal Links**](./#universal-links)\*\*\*\*
  * [ ] Check if the application is **registering any universal protocol/scheme**
  * [ ] Check the **`apple-app-site-association`** file
  * [ ] Check if the application **isn't checking and sanitizing** users input via the custom scheme and some **vulnerability can be exploited**
  * [ ] Check if the application **exposes any sensitive action** that can be called from anywhere via the custom scheme
* \*\*\*\*[**UIActivity Sharing**](ios-uiactivity-sharing.md)\*\*\*\*
  * [ ] Check if the application can receive UIActivities and if it's possible to exploit any vulnerability with specially crafted activity
* \*\*\*\*[**UIPasteboard**](ios-uipasteboard.md)\*\*\*\*
  * [ ] Check if the application if **copying anything to the general pasteboard**
  * [ ] Check if the application if **using the data from the general pasteboard for anything**
  * [ ] Monitor the pasteboard to see if any **sensitive data is copied**
* \*\*\*\*[**App Extensions**](ios-app-extensions.md)\*\*\*\*
  * [ ] Is the application **using any extension**?
* [**WebViews**](ios-webviews.md)\*\*\*\*
  * [ ] Check which kind of webviews are being used
  * [ ] Check the status of **`javaScriptEnabled`**, **`JavaScriptCanOpenWindowsAutomatically`**, **`hasOnlySecureContent`**
  * [ ] Check if the webview can **access local files** with the protocol **file://** **\(**`allowFileAccessFromFileURLs`, `allowUniversalAccessFromFileURLs`\)
  * [ ] Check if Javascript can access **Native** **methods** \(`JSContext`, `postMessage`\)

### Network Communication

* [ ] Perform a [**MitM to the communication**](./#network-communication) and search for web vulnerabilities.
* [ ] Check if the [**hostname of the certificate**](./#hostname-check) is checked
* [ ] Check/Bypass [**Certificate Pinning**](./#certificate-pinning)\*\*\*\*

### **Misc**

* [ ] Check for [**automatic patching/updating**](./#hot-patching-enforced-updateing) mechanisms
* [ ] Check for [**malicious third party libraries**](./#third-parties)\*\*\*\*

